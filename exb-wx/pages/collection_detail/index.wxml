<!-- 藏品详情页面 -->
<view class="container">
  <!-- 返回按钮 -->
  <button class="back-btn" bindtap="goBack">
    <mp-icon type="field" icon="back" color="black" size="{{15}}"></mp-icon>
  </button>

  <!-- 加载状态 -->
  <view class="loading-container" wx:if="{{isLoading}}">
    <text class="loading-text">加载中...</text>
  </view>

  <!-- 滚动内容区域 -->
  <scroll-view class="content" scroll-y="true" bindscroll="onScroll" scroll-top="{{scrollTop}}" enable-back-to-top="true">

    <!-- 图片轮播 -->
    <view class="carousel-container" wx:if="{{!isLoading}}">
      <swiper class="carousel-swiper" indicator-dots="{{true}}" indicator-color="rgba(255, 255, 255, 0.5)" indicator-active-color="#fff" autoplay="{{false}}" circular="{{false}}" interval="5000" duration="500">
        <swiper-item wx:for="{{mediaList}}" wx:key="index" wx:if="{{item.type === 1}}">
          <view class="carousel-item">
            <image class="carousel-image" src="{{static_url}}{{item.url}}"
              mode="aspectFill"
              bindtap="previewImage"
              data-index="{{index}}"></image>
          </view>
        </swiper-item>
        <!-- 如果没有图片类型的媒体，使用占位图 -->
        <swiper-item wx:if="{{!hasImage || mediaList.length === 0}}">
          <view class="carousel-item">
            <image class="carousel-image" src="/wx_static/tmp_images/placeholder_image.png" mode="aspectFill"></image>
          </view>
        </swiper-item>
      </swiper>
    </view>

    <view class="info-section" wx:if="{{!isLoading}}">
      <view class="title-section">
        <text class="collection-title">{{collection.name}}</text>
        <view class="tag-container">
          <!-- 根据单元类型显示标签 -->
          <text class="tag tag-primary">{{collection.type}}</text>
          <!-- <text class="tag tag-secondary">考古</text> -->
          <!-- <text class="tag tag-accent" wx:elif="{{unit.unitType === 2}}">多媒体单元</text>
          <text class="tag tag-section" wx:if="{{unit.section}}">{{unit.section}}</text> -->
        </view>
      </view>

      <view class="divider"></view>

      <!-- 语音讲解 -->
      <view class="audio-section" wx:if="{{hasAudio && !isLoading}}">
        <view class="audio-player-container">
          <view class="audio-btn" bindtap="playCollectionAudio">
            <mp-icon type="field" icon="{{audioState === 'playing' ? 'pause' : 'play2'}}" color="#4299f0" size="{{40}}"></mp-icon>          
          </view>
          <view class="detail-content">
            <text class="audio-name">{{'藏品语音讲解'}}</text>
            <text class="audio-value">{{audioState === 'playing' ? '正在播放' : '正在播放'}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 藏品基本信息 -->
    <view class="info-section" wx:if="{{!isLoading}}">
      <view class="section-header">
        <view class="section-header-content">
          <text class="iconfont icon-info-circle" style="font-size: 20px; color: #4299f0;"></text>
          <text class="section-title section-title-with-icon">基本信息</text>
        </view>
      </view>
      
      <view class="detail-grid">
        <!-- 材质 -->
        <view class="detail-item" wx:if="{{collection.material}}">
          <view class="icon-container">
            <text class="iconfont icon-shapes" style="font-size: 20px;"></text>
          </view>
          <view class="detail-content">
            <text class="label">材质</text>
            <text class="value">{{collection.material}}</text>
          </view>
        </view>
    
        <!-- 年代 -->
        <view class="detail-item" wx:if="{{collection.age}}">
          <view class="icon-container">
            <text class="iconfont icon-calendar-days" style="font-size: 20px;"></text>
          </view>
          <view class="detail-content">
            <text class="label">年代</text>
            <text class="value">{{collection.age}}</text>
          </view>
        </view>
    
        <!-- 作者 -->
        <view class="detail-item" wx:if="{{collection.author}}">
          <view class="icon-container">
            <text class="iconfont icon-chalkboard-user" style="font-size: 20px;"></text>
          </view>
          <view class="detail-content">
            <text class="label">作者/来源</text>
            <text class="value">{{collection.author}}</text>
          </view>
        </view>
    
        <!-- 收藏单位 -->
        <view class="detail-item" wx:if="{{collection.museumName}}">
          <view class="icon-container">
            <text class="iconfont icon-location-dot" style="font-size: 20px;"></text>
          </view>
          <view class="detail-content">
            <text class="label">收藏单位</text>
            <text class="value">{{collection.museumName}}</text>
          </view>
        </view>

        <!-- 尺寸 -->
        <view class="detail-item" wx:if="{{collection.sizeInfo}}" style="grid-column: 1/-1">
          <view class="icon-container">
            <text class="iconfont icon-ruler-horizontal" style="font-size: 20px;"></text>
          </view>
          <view class="detail-content">
            <text class="label">尺寸</text>
            <text class="value">{{collection.sizeInfo}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 描述和介绍 -->
    <view class="intro-section" wx:if="{{!isLoading}}">
      <view class="section-header">
        <view class="section-header-content">
          <text class="section-title section-title-with-icon">描述与介绍</text>
        </view>
      </view>
      <text class="intro-text">{{introText || '暂无详细介绍'}}</text>
      <!-- 如果介绍过长可以添加展开收起按钮 -->
      <button class="read-more-btn" bindtap="toggleIntro" wx:if="{{collection.description && collection.description.length > 100}}" style="margin-left: 0rpx;">
        <text>{{showFullIntro ? '收起' : '更多'}}</text>
        <mp-icon type="field" icon="{{showFullIntro ? 'back' : 'arrow'}}" color="#4299f0" size="{{10}}"></mp-icon>
      </button>
    </view>

  </scroll-view>

  <!-- 底部操作栏 -->
  <!-- <view class="bottom-bar" wx:if="{{!isLoading && !hasAudio}}">
    <button class="action-btn" bindtap="collectCollection">
      <mp-icon type="field" icon="star" color="gray" size="{{40}}"></mp-icon>
      <text>收藏</text>
    </button>
  </view> -->
</view>